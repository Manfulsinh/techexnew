<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
  <link rel="stylesheet" href="/js/creat.style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
 
 

</head>
<body>

<style>



</style> 


  <nav class="navbar">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item">
        <a class="nav-link" href="#">Create Post</a>
      </li>
    </ul>
 
    <i class="fa-solid fa-xmark" id="xmark-icon"></i>
    
  </nav>


      
  <div class="pages">
  <textarea id="post-text" placeholder="" ></textarea>
  
    
  </div>
<div class="card-2">
  <div class="container">
    <div class="row">
      <div class="col-sm-6 mk-1">
      <div class="card">
            <div class="card-body">
              <label for="post-image" id="image-label">
                <i class="fa-solid fa-image" id="image-icon"></i>
                <div class="d-flex justify-content-center align-items-center mt-2">
                  <span>Photo/Video</span>
                </div>
              </label>
              <input type="file" id="post-image" accept="image/*, video/*" style="display: none">
            </div>
          </div>
          
        <div class="news-feed"></div>
    </div>
  
      <div class="col-sm-6 mk-1">
        <div class="card">
          <div class="card-body">
            <label for="post-image" id="image-label">
          <i class="fa-solid fa-camera" id="camera-icon"></i>
          <div class="d-flex justify-content-center align-items-center mt-2">
            <span>Camera </span>
            </div></label>
            <input type="file" id="post-image" accept="image/*, video/*" style="display: none">
          </div>
        </div>
        
      </div>
      <div class="post-container">
         <button id="post-button"class="btn btn-secondary">Post</button>
         </div> 
    </div>
  </div></div>   

  


  
 


<script src="/js/jquery-3.6.1.min.js"></script>

<script>
  const xmarkIcon = document.getElementById("xmark-icon");
   xmarkIcon.addEventListener("click", () => {
 
     window.history.back();
   });
 
 </script> 


   <script>

    function readFileAsBase64(file, callback) {
  const reader = new FileReader();
  reader.onload = function(e) {
    callback(e.target.result);
  };
  reader.readAsDataURL(file);
}

function createPostObject(postText, base64String) {
  return {
    text: postText,
    image: base64String,
    timestamp: new Date().toISOString(),
    username:localStorage.getItem('Name'),
    userprofile:localStorage.getItem('photoURL'),
    id: new Date().getTime().toString() 
  };
}

function savePosts(postsArray) {
  localStorage.setItem('posts', JSON.stringify(postsArray));
}

function getPosts() {
  const posts = localStorage.getItem('posts');
  return posts ? JSON.parse(posts) : [];
}

function handlePost() {
  const postText = document.getElementById('post-text').value;
  const fileInput = document.getElementById('post-image');
  const file = fileInput.files[0];
  
  const postsArray = getPosts();

  if (file) {
    readFileAsBase64(file, function(base64String) {
      const postObject = createPostObject(postText, base64String);
      postsArray.push(postObject);
      savePosts(postsArray);
      
  
      document.getElementById('post-text').value = '';
      fileInput.value = '';
    });
  } else {
    const postObject = createPostObject(postText, null);
    postsArray.push(postObject);
    savePosts(postsArray);
    
  
    document.getElementById('post-text').value = '';
  }
}

document.getElementById('post-button').addEventListener('click', handlePost);

   </script>



<script type="module">

  import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js';
  import {getFirestore,collection,addDoc,serverTimestamp} from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js';


  const firebaseConfig = {
    apiKey: "AIzaSyDrUOrEvp3T277JmKPOWVAZ90gBIKC9S50",
    authDomain: "fir-b6449.firebaseapp.com",
    projectId: "fir-b6449",
    storageBucket: "fir-b6449.appspot.com",
    messagingSenderId: "511184942927",
    appId: "1:511184942927:web:debcb811d15856fd86b73a",
    measurementId: "G-2TM34PV1YN"
  };



  const app = initializeApp(firebaseConfig);


  const db = getFirestore(app);
const username= localStorage.getItem('Name')
const userprofile = localStorage.getItem('photoURL')
  
  function savePostToFirestore(postText, base64Image) {
    const post = {
      text: postText,
      image: base64Image,
      timestamp: serverTimestamp(), 
      username: username,
      userprofile: userprofile,
    };


    addDoc(collection(db, "posts"), post)
      .then((docRef) => {
        console.log("Document written with ID: ", docRef.id);
      })
      .catch((error) => {
        console.error("Error adding document: ", error);
      });
  }




  document.getElementById('post-button').addEventListener('click', function() {
    const postText = document.getElementById('post-text').value;
    const fileInput = document.getElementById('post-image');
    const file = fileInput.files[0];

    if (file) {
      readFileAsBase64(file, function(base64Image) {

        savePostToFirestore(postText, base64Image);
      });
    } else {
      
      savePostToFirestore(postText, null);
    }
  });


  function readFileAsBase64(file, callback) {
    const reader = new FileReader();
    reader.onload = function(e) {
      callback(e.target.result);
    };
    reader.readAsDataURL(file);
  }
</script>



</body>
</html>