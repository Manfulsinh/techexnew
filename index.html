Copy code
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TechX</title>
    <link rel="shortcut icon" href="./img/logo1-remove.png" type="image/x-icon">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
        integrity="sha384-GLhlTQ8iowen0O8QIo94DJWw2H6Z5FmEV8M4A/A7Fjk5IxlVP8BO5S98tP1bpqL" crossorigin="anonymous">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <!-- Your custom CSS -->
    <link rel="stylesheet" href="././js/main.css">
    <base href="/techexnew/">

</head>

<body>
    <div class="container">
        <div>
            <center><img src="./img/TechX_logo-remove.png" alt=""></center>
        </div>
        <div>
            <div class="social-login">
                <center>
                    <!-- Your existing buttons for Facebook and Google login -->
                    <button class="facebook" id="flogin">
                        <!-- Facebook icon -->
                        <i class="fab fa-facebook"></i>&emsp;LOG IN WITH FACEBOOK
                    </button><br>
                    <button class="social-signin google" id="glogin">
                        <!-- Google icon -->
                        <i class="fab fa-google"></i>&emsp;LOG IN WITH GOOGLE
                    </button>
                </center>
            </div>
        </div>
    </div>



    <script type="module">

        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, FacebookAuthProvider } from "https://www.gstatic.com/firebasejs/10.0.0/firebase-auth.js";
        import { getMessaging, getToken, onMessage } from 'https://www.gstatic.com/firebasejs/10.0.0/firebase-messaging.js';


        const firebaseConfig = {
            apiKey: "AIzaSyDrUOrEvp3T277JmKPOWVAZ90gBIKC9S50",
            authDomain: "fir-b6449.firebaseapp.com",
            projectId: "fir-b6449",
            storageBucket: "fir-b6449.appspot.com",
            messagingSenderId: "511184942927",
            appId: "1:511184942927:web:debcb811d15856fd86b73a",
            measurementId: "G-2TM34PV1YN"
        };


        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const messaging = getMessaging(app, {
            vapidKey: "AAAAdwT_N08:APA91bEqk3mauwwbOjStFFgTErCKCWMzIoHEBLVCIcuwWvtc3a43dBvS2gVAsOy4BTFC6vhx8bNtrTaTAZ-tcZ2aG2Jguzc8RtsgSB6ciTqkJNOy3qfWNKMVNBB1ui1OWIPb9CZUWZ79",
            serviceWorkerRegistration: {
                url: './firebase-messaging-sw.js',// Adjust the path based on your file location
            },
        });
        console.log(messaging, "messaging")
       

        const googleProvider = new GoogleAuthProvider();
        const facebookProvider = new FacebookAuthProvider();


        document.getElementById('glogin').addEventListener('click', (e) => {
            signInWithPopup(auth, googleProvider)
                .then((result) => {

                    const credential = GoogleAuthProvider.credentialFromResult(result);
                    const token = credential.accessToken;
                    const user = result.user;
                    console.log("user", result.user, result)
                    console.log("User Logged in");
                    localStorage.setItem("Name", user.displayName);
                    localStorage.setItem("emailID", user.email);
                    localStorage.setItem("photoURL", user.photoURL);
                    localStorage.setItem("user", user.uid)
                    window.location.href = 'chat.html';
                })
                .catch((error) => {

                    const errorCode = error.code;
                    const errorMessage = error.message;
                    alert(errorMessage);
                });
        });



Notification.requestPermission().then(permission => {
            if (permission === 'granted') {
                console.log('Notification permission granted.');
                
                // Get FCM token
                getToken(messaging, { vapidKey: "BJnzcOgSupGjACmEqinLpEBYtQUHD3DOTdYtyNUyzu9Vp4Ddqb7qL6y6fz7Mg-i1ikElRhzIM3qRFPuZF0kgen4"})
                    .then((currentToken) => {
                        if (currentToken) {
                            console.log('Current FCM token:', currentToken);
                            localStorage.setItem('fcmToken', currentToken);
                        } else {
                            console.log('No FCM token available.');
                        }
                    })
                    .catch((error) => {
                        console.error('An error occurred while retrieving FCM token:', error);
                    });
            }
        });


      

    

    </script>
</body>

</html>
