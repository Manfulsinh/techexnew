
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
  <link rel="stylesheet" href="/js/chat.style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

  <script src="https://apis.google.com/js/api:client.js"></script>
    <title>Document</title>
</head>
<body>


  <style>


.popover-content {
  display: none;
  /* rest of your styles for popover content */
}

.popover-content.show {
  display: block;
}



.card-body .post-image {
  display: block;      
  margin-left: auto;    
  margin-right: auto;  
  max-width: 80%;      
  height: auto;       
}


  </style>
 
<div class="allchat">
  <div class="chat-home">
      <div class="container">
          <div class="row">
              <div class="col-sm-12">
                   <h1 class="text-center teah">Tech</h1>
                  <div class="spne">
                      <span>X</span>
                  </div> 

                
                  <div class="post-section">
                      <div class="post-btn">
                          <a href="/creat.html"><button id="post-button" class="btn btn-secondary">Create Post</button></a>
                      </div>
                  </div>
              </div>
          </div>
      </div>
  </div>



 <div class="card-3">
    <div id="post-container">
   <div class="card-header">
    <img class="avatar" src="/img/whatsaap.jpeg" alt="User Avatar">
    <div class="user-info">
      <div class="user-name">Manful</div>
      <div class="timestamp">3 hours ago</div>
    
    </div> 
    <i id="popoverIcon" class="fas fa-ellipsis-h nice-icon ml-auto"></i>
    
</div>
<div id="popoverContent" class="popover-content">
 <button class="popover-action-btn" onclick="edit(event)">Edit Post</button>
  <button class="popover-action-btn">Delete Post</button>
</div>

 <div class="card-body" id="chatContent">
    <p class="tweet-text">
      Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua
      <br>
      
 
    </p>
  </div>

  <div class="card-footer">
    <i class="fa-regular fa-heart" aria-hidden="true"></i>
    <i class="fa-regular fa-face-smile" aria-hidden="true"></i>
    <i class="fa-solid fa-thumbs-up" aria-hidden="true"></i>
  </div>
 </div>  
    </div> 
 
 

<div class="mobilebar-container mobile-layout">
    <nav class="mobilebar-tab">
        <div id="applicationBarMobileButton1" class="mobilebar-tab-item active">
            <span class="mobilebar-tab__icon">
                <a href="/edit.html"> <i class="fa-solid fa-house"></i></a>
            </span>
        </div>
        <div class="mobilebar-tab-item">
            <span class="mobilebar-tab__icon">
                <a href="/profile.html"><i class="fa-solid fa-user"></i></a>
            </span>
        </div>
    </nav>
</div>






<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

   
<script>
  function renderPost(post) {
    
      return `
        <div class="card mb-3" id="${post.id}">
          <div class="card-header">
            <img class="avatar" src="${post.userprofile}" alt="User Avatar">
            <div class="user-info">
              <div class="user-name">${post.username}</div>
              <div class="timestamp">${new Date(post.timestamp).toLocaleString()}</div>
            </div>
            <i class="fas fa-ellipsis-h nice-icon ml-auto popoverIcon"></i> 
          </div>
           <div class="popover-content">
            <button class="popover-action-btn" data-post-id="${post.id}" onclick="editPost('${post.id}')">Edit Post</button>


            <button class="popover-action-btn">Delete Post</button>
          </div>
          <div class="card-body">
            <p class="tweet-text">${post.text}</p>
            ${post.image ? `<img src="${post.image}" class="post-image" alt="Post Image">` : ''}
          </div>
          <div class="card-footer">
            <i class="fa-regular fa-heart" aria-hidden="true"></i>
            <i class="fa-regular fa-face-smile" aria-hidden="true"></i>
            <i class="fa-solid fa-thumbs-up" aria-hidden="true"></i>
          </div> 
        </div>
        `;
  }
  
  function loadPosts() {
      const postsContainer = document.getElementById('post-container');
      const posts = JSON.parse(localStorage.getItem('posts')) || [];
      posts.reverse();
      posts.forEach(post => {
        const postElement = renderPost(post);
        postsContainer.insertAdjacentHTML('beforeend', postElement);
      });
  }
  
  document.addEventListener('DOMContentLoaded', loadPosts);
  

  document.addEventListener('click', function(event) {
      if (event.target.classList.contains('popoverIcon')) {

          const popoverContent = event.target.closest('.card-header').nextElementSibling;
          if (popoverContent) {
              popoverContent.classList.toggle('show');
          } else {
                console.error('Popover content not found for icon: ', event.target);
          
          }
      }
  });


  function editPost(postId) {
 
 window.location.href = `edit.html?postId=${postId}`;
}




 </script>


 


<script type="module">
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js';
import { getFirestore, collection, addDoc } from 'https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore.js';


  const firebaseConfig = {
    apiKey: "AIzaSyDrUOrEvp3T277JmKPOWVAZ90gBIKC9S50",
    authDomain: "fir-b6449.firebaseapp.com",
    projectId: "fir-b6449",
    storageBucket: "fir-b6449.appspot.com",
    messagingSenderId: "511184942927",
    appId: "1:511184942927:web:debcb811d15856fd86b73a",
    measurementId: "G-2TM34PV1YN"
  };

  const app = initializeApp(firebaseConfig);
const db = getFirestore(app);


function savePostToFirestore(postText, base64Image) {
  const post = {
    text: postText,
    image: base64Image,
    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
    username: "Some Username", 
    userprofile: "Some Profile URL" 
    
  };
console.log("save post")

  db.collection("posts").add(post)
    .then((docRef) => {
      console.log("Document written with ID: ", docRef.id);
    })
    .catch((error) => {
      console.error("Error adding document: ", error);
    });
}



document.getElementById('post-button').addEventListener('click', function() {
  const postText = document.getElementById('post-text').value;
  const fileInput = document.getElementById('post-image');
  const file = fileInput.files[0];

  if (file) {
    readFileAsBase64(file, function(base64Image) {
  
      savePostToFirestore(postText, base64Image);
    });
  } else {
 
    savePostToFirestore(postText, null);
  }
});


function readFileAsBase64(file, callback) {
  const reader = new FileReader();
  reader.onload = function(e) {
    callback(e.target.result);
  };
  reader.readAsDataURL(file);
}




</script>

</body>
</html>
